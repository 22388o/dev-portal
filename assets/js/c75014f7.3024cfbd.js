"use strict";(self.webpackChunkdev_portal=self.webpackChunkdev_portal||[]).push([[7310],{3905:function(e,t,a){a.d(t,{Zo:function(){return l},kt:function(){return u}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function d(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var i=n.createContext({}),c=function(e){var t=n.useContext(i),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},l=function(e){var t=c(e.components);return n.createElement(i.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,i=e.parentName,l=d(e,["components","mdxType","originalType","parentName"]),m=c(a),u=r,f=m["".concat(i,".").concat(u)]||m[u]||p[u]||o;return a?n.createElement(f,s(s({ref:t},l),{},{components:a})):n.createElement(f,s({ref:t},l))}));function u(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,s=new Array(o);s[0]=m;var d={};for(var i in t)hasOwnProperty.call(t,i)&&(d[i]=t[i]);d.originalType=e,d.mdxType="string"==typeof e?e:r,s[1]=d;for(var c=2;c<o;c++)s[c]=a[c];return n.createElement.apply(null,s)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},3335:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return d},contentTitle:function(){return i},metadata:function(){return c},toc:function(){return l},default:function(){return m}});var n=a(7462),r=a(3366),o=(a(7294),a(3905)),s=["components"],d={title:"Deposit funds",sidebar_position:1},i=void 0,c={unversionedId:"provider/daemon/market/deposit_funds",id:"provider/daemon/market/deposit_funds",isDocsHomePage:!1,title:"Deposit funds",description:"The flow to create and deposit funds to a new market has been changed starting from version v0.6.0.",source:"@site/docs/provider/daemon/market/deposit_funds.md",sourceDirName:"provider/daemon/market",slug:"/provider/daemon/market/deposit_funds",permalink:"/docs/provider/daemon/market/deposit_funds",editUrl:"https://github.com/tdex-network/dev-portal/edit/master/docs/provider/daemon/market/deposit_funds.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"Deposit funds",sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Manage account",permalink:"/docs/provider/daemon/fee/manage_account"},next:{title:"Manage a market",permalink:"/docs/provider/daemon/market/manage_account"}},l=[{value:"Create a new market",id:"create-a-new-market",children:[]},{value:"Manually deposit funds",id:"manually-deposit-funds",children:[]},{value:"Fragmenter",id:"fragmenter",children:[]}],p={toc:l};function m(e){var t=e.components,a=(0,r.Z)(e,s);return(0,o.kt)("wrapper",(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"The flow to create and deposit funds to a new market has been changed starting from version v0.6.0."),(0,o.kt)("p",null,"Before this version the market's asset pair was deducted by the daemon by checking the asset types of the claimed deposits.",(0,o.kt)("br",{parentName:"p"}),"\n","Starting from v0.6.0 you're in charge of explicitly create a market by specifying its asset pair before sending funds to it."),(0,o.kt)("h2",{id:"create-a-new-market"},"Create a new market"),(0,o.kt)("p",null,"Starting from v0.6.0 the first thing you have to do for opening a market is to explicitly create it by specifying its asset pair:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"$ tdex market new --base_asset 5ac9f65c0efcc4775e0baec4ec03abdde22473cd3cf33c0419ca290e0751b225 --quote_asset b33ddc389d5dabae5b8e371b535433b1c18505ecf656fce6ca8540c07ec2bde5\n#\n# market created\n")),(0,o.kt)("p",null,"Now that the market is created, it needs to be funded with funds of both its base and quote assets.",(0,o.kt)("br",{parentName:"p"}),"\n","Before doing that, though, you have to set the assets of the market in your CLI config:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"$ tdex config set base_asset 5ac9f65c0efcc4775e0baec4ec03abdde22473cd3cf33c0419ca290e0751b225\n# base_asset 5ac9f65c0efcc4775e0baec4ec03abdde22473cd3cf33c0419ca290e0751b225 has been set\n\n$ tdex config set quote_asset b33ddc389d5dabae5b8e371b535433b1c18505ecf656fce6ca8540c07ec2bde5\n# quote_asset b33ddc389d5dabae5b8e371b535433b1c18505ecf656fce6ca8540c07ec2bde5 has been set\n")),(0,o.kt)("p",null,"You're ready to deposit the funds! You can choose to ",(0,o.kt)("a",{parentName:"p",href:"#manually-deposit-funds"},"manually deposit the funds")," into the market or to use the ",(0,o.kt)("a",{parentName:"p",href:"#fragmenter"},"Fragmenter")," to automatically split funds sent to an ephemeral address into many smaller ones that will be deposited into the market."),(0,o.kt)("h2",{id:"manually-deposit-funds"},"Manually deposit funds"),(0,o.kt)("p",null,"Get some deposit address(es):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'tdex market deposit --num_of_addresses 2\n# {\n#   "address_with_blinding_key": [\n#       {\n#           "address": "el1qq2gn3y2r5405dppjk2yc2tjg0zxxy35fr0y9lc3yyrnyf07ktuht0ymzrh8hnjwl62w9ws6jwl3yh40k8cd26wfc27sug3rmh",\n#           "blinding": "2fab376ffecbee0cb7b70794373be35c7b24340a2652f1a10c8200b04ab3eedb"\n#       },\n#     {\n#       "address": "el1qq092gt6vyda85eqmqk5xh6dmjujljvm5mjzurn9k36nu6f6veheqqyh3hgtlwpd0y70tdccf5ua395hugwjv2ccw237cl9tal",\n#       "blinding": "7eab1dea4e504bb90ff96e692393ecb55f9edf9e4c840cd820e24ef27f4a27b0"\n#     }\n#   ]\n# }\n')),(0,o.kt)("p",null,"Send funds of both the base and quote asset to the address(es) and ",(0,o.kt)("strong",{parentName:"p"},"only after")," the transaction(s) gets confirmed, you can claim the deposits for the market:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'$ tdex-cli market claim --outpoints \'[{"hash": "a85d92ce884cc578c28dc976166ab848c78580ab217d3cb66ab44f423e402adb", "index": 1}, {"hash": "57fc2ff04316f753a042b129a2f381471baf1adb11caa5e596a6c9ac339ebc47", "index": 1}]\'\n\n#\xa0market is funded\n')),(0,o.kt)("p",null,"Done! You have created and funded a new market. You may want to take a look at the other commands of the operator CLI to ",(0,o.kt)("a",{parentName:"p",href:"/docs/provider/daemon/market/manage_account"},"manage a market")),(0,o.kt)("h2",{id:"fragmenter"},"Fragmenter"),(0,o.kt)("p",null,"The fragmenter is an interactive process that helps you splitting few UTXOs into many with smaller amounts. It makes use of an ephemeral single-key wallet that is no longer used after the process is completed (or aborted).  "),(0,o.kt)("p",null,"To start the fragmenter for a market account run:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"$ tdex-cli fragmentmarket\n# INFO[0000] send funds to address: el1qqglmel983rhht7cw7ta62xh0xvjh83r65m7d4rjfnswla8da4l6kx5fhrsy4m9wuvmyynre730qguggfahhvyn2cpqqpdwhac\n# INFO[0000] Enter txid of fund(s) separated by a white space [press ENTER to skip or confirm]:\n")),(0,o.kt)("p",null,"After generating and showing the ephemeral address, the command waits for you to prompt the txid of the funding tx(s).",(0,o.kt)("br",{parentName:"p"}),"\n","Press ",(0,o.kt)("em",{parentName:"p"},"ENTER")," to confirm and continue the process: the tool calculates the optimal number of fragments based on the amount detected and sends the deposit fragments to the daemon's market account."),(0,o.kt)("p",null,"If, for any reason, the process fails (like for example you pasted the wrong txid, or you forgot to unlock the wallet before this step) you can always resume it with:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"$ tdex fragmentmarket --txid <txid1> --txid <txid2> ...\n")),(0,o.kt)("p",null,"The fragmenter is smart enough to recognize if any previous attempt exited before being completed. In that case, it expects you to resume that one by providing the list of funding txids. If this time everything's allright, the process will complete as described above. Only after a fragmentation process is completed, it is possible to go for another one."),(0,o.kt)("p",null,'Another option is to abort the pending process instead of resuming it and send the "stuck" funds back to an address of yours instead of depositing them into the daemon HD wallet:'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"$ tdex fragmentfee --recover_funds_to_address <address>\n")),(0,o.kt)("p",null,"This will send all the funds owned by the fragmenter to the specified address and abort the process instead of completing it."),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"If you have funds stuck on the ephemeral wallet of the fragmenter, it is strongly suggested to backup your operator CLI datadir (usually located at ",(0,o.kt)("inlineCode",{parentName:"p"},"~/.tdex-operator")," in Linux or `~/Library/Application\\ Support/Tdex-operator in OSX) as long as you haven't completed or aborted the process, in order to prevent loosing them if you delete the datadir by accident."))),(0,o.kt)("p",null,"This is all you have to do, the fragmenter will take care of all the rest. Once the process is completed, take a look at all other commands that let's you ",(0,o.kt)("a",{parentName:"p",href:"/docs/provider/daemon/market/manage_account"},"manage a market"),"."))}m.isMDXComponent=!0}}]);